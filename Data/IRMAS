import os
import librosa
import numpy as np
import pandas as pd
from tqdm import tqdm # for progress tracking

#Extracting audio features using librosa.
def extract_audio_features(file_path, sr=22050): #filepath, librosa sampling rate

    try:
        #Load audio file
        y, sr = librosa.load(file_path, sr=sr)

        #Extract features
        features = {
            "mfcc_mean": np.mean(librosa.feature.mfcc(y=y, sr=sr, n_mfcc=13), axis=1), #Mean of each MFCC (Mel-frequency cepstral coefficients); Captures timbre
            "spectral_centroid_mean": np.mean(librosa.feature.spectral_centroid(y=y, sr=sr)), #Perceived Brightness
            "spectral_bandwidth_mean": np.mean(librosa.feature.spectral_bandwidth(y=y, sr=sr)),
            "chroma_stft_mean": np.mean(librosa.feature.chroma_stft(y=y, sr=sr)), #Harmonic and pitch content
            "zero_crossing_rate_mean": np.mean(librosa.feature.zero_crossing_rate(y=y)),#Measures Noisiness
        }

        return features #Return dictionary of extracted features
    except Exception as e:
        print(f"Error processing {file_path}: {e}")
        return None